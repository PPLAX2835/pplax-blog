# PPLAX-Blog

ä¸ªäººå¼€å‘çš„ä¸€ä¸ªåšå®¢é¡¹ç›®ï¼Œå› ä¸ºçœ‹è§åˆ«äººçš„åšå®¢é¡¹ç›®ï¼Œå°±è§‰å¾—å¾ˆå‰å®³ï¼Œç„¶åè‡ªå·±ä¹Ÿæƒ³æ•´ä¸€ä¸ªï¼ˆå½“å‰éƒ¨ç½²ä¸äº†ï¼Œç§Ÿçš„æœåŠ¡å™¨å¤ªæ‹‰...ï¼‰

ç›®å‰åšåˆ°äº†Spring Gateway + Oauth2çš„ç»Ÿä¸€ç™»å½•è®¤è¯ã€æƒé™åŠèœå•åŠ¨æ€åˆ†é…ã€mysqlä¸ç¼“å­˜ç›¸å…³çš„ä¼˜åŒ–ã€ç»Ÿä¸€å¼‚å¸¸å¤„ç†ã€æ¶ˆæ¯é˜Ÿåˆ—å¯¹è¯„è®ºç­‰ç›¸å…³æ•°æ®çš„å¤„ç†ã€restfulé£æ ¼çš„apiç­‰

## é¡µé¢å›¾ç‰‡

åå°

â€‹![image](assets/image-20240503204942-z6txsse.png)â€‹

å‰å°

â€‹![image](assets/image-20240503205008-7plb5q8.png)â€‹

å°±å±•ç¤ºè¿™ç‚¹å§

## ç”¨åˆ°çš„æŠ€æœ¯

### åç«¯

â€‹`Spring Cloud Alibaba`â€‹ `Spring Boot`â€‹  `My batis-plus`â€‹ `Spring Security Oauth2`â€‹ `Spring Cloud Gateway`â€‹ `druid`â€‹ ç­‰ç­‰å§

ä¸»è¦å‚è€ƒäº†

[è˜‘è‡åšå®¢: è˜‘è‡åšå®¢(MoguBlog)ï¼Œä¸€ä¸ªåŸºäºå¾®æœåŠ¡æ¶æ„çš„å‰åç«¯åˆ†ç¦»åšå®¢ç³»ç»Ÿã€‚Webç«¯ä½¿ç”¨Vue + Element , ç§»åŠ¨ç«¯ä½¿ç”¨uniappå’ŒColorUIã€‚åç«¯ä½¿ç”¨Spring cloud + Spring boot + mybatis-plusè¿›è¡Œå¼€å‘ï¼Œä½¿ç”¨ Jwt + Spring Securityåšç™»å½•éªŒè¯å’Œæƒé™æ ¡éªŒï¼Œä½¿ç”¨ElasticSearchå’ŒSolrä½œä¸ºå…¨æ–‡æ£€ç´¢æœåŠ¡ï¼Œä½¿ç”¨Github Actionså®Œæˆåšå®¢çš„æŒç»­é›†æˆï¼Œä½¿ç”¨ELKæ”¶é›†åšå®¢æ—¥å¿—ï¼Œæ–‡ä»¶æ”¯æŒä¸Šä¼ ä¸ƒç‰›äº‘å’ŒMinioï¼Œæ”¯æŒDocker Composeè„šæœ¬ä¸€é”®éƒ¨ç½²ã€‚ (gitee.com)](https://gitee.com/moxi159753/mogu_blog_v2)

[RuoYi-Cloud: ğŸ‰ åŸºäºSpring Bootã€Spring Cloud &amp; Alibabaçš„åˆ†å¸ƒå¼å¾®æœåŠ¡æ¶æ„æƒé™ç®¡ç†ç³»ç»Ÿï¼ŒåŒæ—¶æä¾›äº† Vue3 çš„ç‰ˆæœ¬ (gitee.com)](https://gitee.com/y_project/RuoYi-Cloud)

[GitHub - xcyeye/aurora-blog: ğŸ”¥Auroraåšå®¢æ˜¯ä¸€ä¸ªåŸºäºSpring Cloud Alibabaçš„å¤šäººå¾®æœåŠ¡åšå®¢é¡¹ç›®ï¼Œå‰å°å’Œåå°ç•Œé¢éå¸¸æ¼‚äº®ï¼Œç‰¹å¾ï¼šé‚®ç®±é“¾æ¥éªŒè¯ã€è´¦æˆ·é”å®šç­‰é‚®ä»¶åŠŸèƒ½ã€‚å‰ç«¯æŠ€æœ¯ï¼šTypeScript + Vue3 + Pinia + NaiveUiï¼Œåç«¯æŠ€æœ¯ï¼šSpring Cloud Alibaba + RabbitMq + Seata + Oauth2ã€‚](https://github.com/xcyeye/aurora-blog)

ç­‰å¤§ä½¬çš„é¡¹ç›®

### å‰ç«¯

â€‹`vue2`â€‹ `element-ui`â€‹

å‰å°ä½¿ç”¨äº†[æ‹¾å£¹åšå®¢: ä¸€æ¬¾vue+springbootå‰åç«¯åˆ†ç¦»çš„åšå®¢ç³»ç»Ÿï¼Œåšå®¢åå°ç®¡ç†ç³»ç»Ÿä½¿ç”¨äº†vue+elmentuiå¼€å‘ï¼Œåç«¯ä½¿ç”¨Sa-Tokenè¿›è¡Œæƒé™ç®¡ç†,æ”¯æŒåŠ¨æ€èœå•æƒé™ï¼ŒåŠ¨æ€å®šæ—¶ä»»åŠ¡ï¼Œæ–‡ä»¶æ”¯æŒæœ¬åœ°å’Œä¸ƒç‰›äº‘ä¸Šä¼ ï¼Œä½¿ç”¨ElasticSearchä½œä¸ºå…¨æ–‡æ£€ç´¢æœåŠ¡ï¼Œæ”¯æŒQQã€å¾®ä¿¡å…¬ä¼—å·æ‰«ç ã€ç äº‘ã€GitHubç™»å½•ã€‚å®ç°å³æ—¶é€šè®¯èŠå¤©å®¤åŠŸèƒ½ (gitee.com)](https://gitee.com/quequnlong/shiyi-blog)çš„å‰å°é¡¹ç›®ï¼ˆéå¸¸æ„Ÿè°¢ï¼‰

â€

## å¦‚ä½•è·‘èµ·æ¥

### ç¯å¢ƒä¾èµ–

â€‹`MySQL 8`â€‹ `rabbitmq 3.9.1`â€‹ `nacos-server 2.2.0`â€‹ `minio`â€‹ `nodejs 12.22.12`â€‹ `Java 8`â€‹ å¤§æ¦‚æ˜¯è¿™äº›

#### docker-compose

```bash
# MySQL 8 å¯å‚è€ƒï¼š https://hub.docker.com/_/mysqlersion: '3'
services:
  mysql:
    image: registry.cn-hangzhou.aliyuncs.com/zhengqing/mysql:8.0  # åŸé•œåƒ`mysql:8.0`
    container_name: mysql8                                    # å®¹å™¨åä¸º'mysql8'
    restart: unless-stopped                                               # æŒ‡å®šå®¹å™¨é€€å‡ºåçš„é‡å¯ç­–ç•¥ä¸ºå§‹ç»ˆé‡å¯ï¼Œä½†æ˜¯ä¸è€ƒè™‘åœ¨Dockerå®ˆæŠ¤è¿›ç¨‹å¯åŠ¨æ—¶å°±å·²ç»åœæ­¢äº†çš„å®¹å™¨
    volumes:                                                      # æ•°æ®å·æŒ‚è½½è·¯å¾„è®¾ç½®,å°†æœ¬æœºç›®å½•æ˜ å°„åˆ°å®¹å™¨ç›®å½•
      - "./mysql/my.cnf:/etc/mysql/my.cnf"
      - "./mysql/data:/var/lib/mysql"
#      - "./mysql/conf.d:/etc/mysql/conf.d"
      - "./mysql/mysql-files:/var/lib/mysql-files"
    environment:                        # è®¾ç½®ç¯å¢ƒå˜é‡,ç›¸å½“äºdocker runå‘½ä»¤ä¸­çš„-e
      TZ: Asia/Shanghai
      LANG: en_US.UTF-8
      MYSQL_ROOT_PASSWORD: root         # è®¾ç½®rootç”¨æˆ·å¯†ç 
      MYSQL_DATABASE: demo              # åˆå§‹åŒ–çš„æ•°æ®åº“åç§°
    privileged: true
    user: root
    ports:                              # æ˜ å°„ç«¯å£
      - "3306:3306"

```

```bash
# docker-composeå‚è€ƒï¼šhttps://github.com/nacos-group/nacos-docker/blob/master/example/standalone-mysql-5.7.yaml
# Nacosæ–‡æ¡£ï¼šhttps://nacos.io/zh-cn/index.html
version: '3'

# ç½‘æ¡¥ -> æ–¹ä¾¿ç›¸äº’é€šè®¯
networks:
  nacos:
    driver: bridge

services:
  nacos:
    image: registry.cn-hangzhou.aliyuncs.com/zhengqing/nacos-server:2.2.0    # åŸé•œåƒ`nacos/nacos-server:2.2.0`
    container_name: nacos_server                                 # å®¹å™¨åä¸º'nacos_server'
    restart: unless-stopped                                              # æŒ‡å®šå®¹å™¨é€€å‡ºåçš„é‡å¯ç­–ç•¥ä¸ºå§‹ç»ˆé‡å¯ï¼Œä½†æ˜¯ä¸è€ƒè™‘åœ¨Dockerå®ˆæŠ¤è¿›ç¨‹å¯åŠ¨æ—¶å°±å·²ç»åœæ­¢äº†çš„å®¹å™¨
    volumes:                                                     # æ•°æ®å·æŒ‚è½½è·¯å¾„è®¾ç½®,å°†æœ¬æœºç›®å½•æ˜ å°„åˆ°å®¹å™¨ç›®å½•
      - "./nacos/logs:/home/nacos/logs"
    environment:                        # è®¾ç½®ç¯å¢ƒå˜é‡,ç›¸å½“äºdocker runå‘½ä»¤ä¸­çš„-e
      - PREFER_HOST_MODE=hostname                 # å¦‚æœæ”¯æŒä¸»æœºåå¯ä»¥ä½¿ç”¨hostname,å¦åˆ™ä½¿ç”¨ipï¼Œé»˜è®¤ä¹Ÿæ˜¯ip
      - MODE=standalone                           # å•æœºæ¨¡å¼å¯åŠ¨
      - SPRING_DATASOURCE_PLATFORM=mysql          # æ•°æ®æºå¹³å° ä»…æ”¯æŒmysqlæˆ–ä¸ä¿å­˜empty
      # TODO ä¿®æ”¹mysqlè¿æ¥ä¿¡æ¯
      - MYSQL_SERVICE_HOST=192.168.32.1          # æ³¨ï¼šè¿™é‡Œä¸èƒ½ä¸º`127.0.0.1`æˆ–`localhost`æ–¹å¼ï¼ï¼ï¼
      - MYSQL_SERVICE_DB_NAME=nacos_config        # è¿™é‡Œéœ€è¦æ‰§è¡Œnacos_config.sql
      - MYSQL_SERVICE_PORT=3306
      - MYSQL_SERVICE_USER=root
      - MYSQL_SERVICE_PASSWORD=root
      # TODO ä¿®æ”¹JVMè°ƒä¼˜å‚æ•°
      - JVM_XMS=128m   #-Xms default :2g
      - JVM_XMX=128m   #-Xmx default :2g
      - JVM_XMN=64m    #-Xmn default :1g
      - JVM_MS=32m     #-XX:MetaspaceSize default :128m
      - JVM_MMS=32m    #-XX:MaxMetaspaceSize default :320m
    ports:
      - "8848:8848"
    networks:
      - nacos
    mem_limit: 1000m   # æœ€å¤§ä½¿ç”¨å†…å­˜

```

```bash
# ç¯å¢ƒå˜é‡å¯å‚è€ƒï¼š https://www.rabbitmq.com/configure.html
#               https://github.com/rabbitmq/rabbitmq-server/blob/master/deps/rabbit/docs/rabbitmq.conf.example
version: '3'
services:
  rabbitmq:
    image: registry.cn-hangzhou.aliyuncs.com/zhengqing/rabbitmq:3.9.1-management        # é•œåƒ`rabbitmq:3.9.1-management` ã€ æ³¨ï¼šè¯¥ç‰ˆæœ¬åŒ…å«äº†webæ§åˆ¶é¡µé¢ ã€‘
    container_name: rabbitmq            # å®¹å™¨åä¸º'rabbitmq'
    hostname: my-rabbit
    restart: unless-stopped                                       # æŒ‡å®šå®¹å™¨é€€å‡ºåçš„é‡å¯ç­–ç•¥ä¸ºå§‹ç»ˆé‡å¯ï¼Œä½†æ˜¯ä¸è€ƒè™‘åœ¨Dockerå®ˆæŠ¤è¿›ç¨‹å¯åŠ¨æ—¶å°±å·²ç»åœæ­¢äº†çš„å®¹å™¨
    environment:                        # è®¾ç½®ç¯å¢ƒå˜é‡,ç›¸å½“äºdocker runå‘½ä»¤ä¸­çš„-e
      TZ: Asia/Shanghai
      LANG: en_US.UTF-8
    volumes:                            # æ•°æ®å·æŒ‚è½½è·¯å¾„è®¾ç½®,å°†æœ¬æœºç›®å½•æ˜ å°„åˆ°å®¹å™¨ç›®å½•
      - "./rabbitmq/config/rabbitmq.conf:/etc/rabbitmq/rabbitmq.conf"
      - "./rabbitmq/config/10-default-guest-user.conf:/etc/rabbitmq/conf.d/10-default-guest-user.conf"
      - "./rabbitmq/data:/var/lib/rabbitmq"
      - "./rabbitmq/plugins/rabbitmq_delayed_message_exchange-3.9.0.ez:/opt/rabbitmq/plugins/rabbitmq_delayed_message_exchange-3.9.0.ez"
#      - "./rabbitmq/log:/var/log/rabbitmq"
    ports:                              # æ˜ å°„ç«¯å£
      - "5672:5672"
      - "15672:15672"

```

```bash
# å¯å‚è€ƒ https://docs.min.io/docs/minio-docker-quickstart-guide.html
version: '3'
services:
  minio:
    image: minio/minio:latest                                    # åŸé•œåƒ`minio/minio:latest`
    container_name: minio                                        # å®¹å™¨åä¸º'minio'
    restart: unless-stopped                                              # æŒ‡å®šå®¹å™¨é€€å‡ºåçš„é‡å¯ç­–ç•¥ä¸ºå§‹ç»ˆé‡å¯ï¼Œä½†æ˜¯ä¸è€ƒè™‘åœ¨Dockerå®ˆæŠ¤è¿›ç¨‹å¯åŠ¨æ—¶å°±å·²ç»åœæ­¢äº†çš„å®¹å™¨
    volumes:                                                     # æ•°æ®å·æŒ‚è½½è·¯å¾„è®¾ç½®,å°†æœ¬æœºç›®å½•æ˜ å°„åˆ°å®¹å™¨ç›®å½•
      - "./minio/data:/data"
      - "./minio/minio:/minio"
      - "./minio/config:/root/.minio"
    environment:                                      # è®¾ç½®ç¯å¢ƒå˜é‡,ç›¸å½“äºdocker runå‘½ä»¤ä¸­çš„-e
      TZ: Asia/Shanghai
      LANG: en_US.UTF-8
      MINIO_PROMETHEUS_AUTH_TYPE: "public"
      MINIO_ACCESS_KEY: "root"                        # ç™»å½•è´¦å·
      MINIO_SECRET_KEY: "password"                    # ç™»å½•å¯†ç 
    command: server /data  --console-address ":9001"
    logging:
      driver: "json-file"
      options:
        max-size: "100m"
    ports:                              # æ˜ å°„ç«¯å£
      - "9002:9000" # æ–‡ä»¶ä¸Šä¼ &é¢„è§ˆç«¯å£
      - "9001:9001" # æ§åˆ¶å°è®¿é—®ç«¯å£

```

#### ç”¨åˆ°çš„sqlè„šæœ¬

åˆ†åˆ«åˆ›å»ºå¯¹åº”æ–‡ä»¶åçš„æ•°æ®åº“ï¼Œç„¶ååˆ†åˆ«æ‰§è¡Œå°±å¥½

[nacos_config.sql](assets/nacos_config-20240503210201-w0t84y5.sql)

[pplax_blog.sql](assets/pplax_blog-20240503210201-9ehnzum.sql)
